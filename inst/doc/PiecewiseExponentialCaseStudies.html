<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Keaven Anderson" />


<title>Piecewise Exponential Fits to Test Cases</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Piecewise Exponential Fits to Test Cases</h1>
<h4 class="author"><em>Keaven Anderson</em></h4>
<h4 class="date"><em>August 9, 2017</em></h4>



<p>We fit initial piecewise exponential distributions to fit case studies for non-proportional hazards. There are 6 test cases that are divided into 5 sections below: 2 cases with delayed benefit, one cure model with proportional hazards, one belly shaped difference (expanding and then coming together), one with increasing treatment effect over time (widening), and one with crossing survival function. Each dataset is in an R dataset in the data directory of the package (Ex1delayedEffect, Ex2delayedEffect, Ex3curewithph, Ex4belly, Ex5widening, Ex6crossing), each with a corresponding help file. In each file, there is a suggested fit using the piecewise exponential distribution. Below, we re-derive these fits and compare the results to the Kaplan-Meier curves for each dataset. We also do a likelihood ratio test for any treatment effect and compare to the logrank test.</p>
<div id="delayed-benefit-cases-1-and-2" class="section level2">
<h2>Delayed benefit: cases 1 and 2</h2>
<p>We begin with Kaplan-Meier curves for test cases 1 and 2 using the survminer package function ggsurvplot. Note that the data structure for each test case is exactly the same as seen below. The function <code>ggsurvplot</code> is from the <code>survminer</code> package available at CRAN.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(month, evntd) ~<span class="st"> </span>trt,
               <span class="dt">data =</span> Ex1delayedEffect)
fit2 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(month, evntd) ~<span class="st"> </span>trt,
               <span class="dt">data =</span> Ex2delayedEffect)
Ex1KMPlot&lt;-<span class="kw">ggsurvplot</span>(fit1, <span class="dt">data =</span> Ex1delayedEffect, <span class="dt">risk.table =</span> <span class="ot">TRUE</span>, <span class="dt">break.time.by=</span><span class="dv">3</span>)
Ex2KMPlot&lt;-<span class="kw">ggsurvplot</span>(fit2, <span class="dt">data =</span> Ex2delayedEffect, <span class="dt">risk.table =</span> <span class="ot">TRUE</span>, <span class="dt">break.time.by=</span><span class="dv">3</span>)
Ex1KMPlot</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ex2KMPlot</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="piecewise-exponential-fitting" class="section level3">
<h3>Piecewise exponential fitting</h3>
<p>For each test case, we use <code>pwexpfit</code> to fit piecewise exponential survival distributions by treatment group. The defaults of 3 intervals of length 3 is used and the routine automatically adds on another interval of indefinite length when there are patients followed for more than 9 months in each case. (PRESUMABLY THESE APPROXIMATE TIMING OF SCANS FOR THESE STUDIES). The variables shown in the table for each interval are as follows:</p>
<ul>
<li><code>intervals</code> - interval length,</li>
<li><code>TTOT</code> - total time on test for all observations in interval,</li>
<li><code>events</code> - events occuring in interval,</li>
<li><code>rate</code> - event rate (<code>events / TTOT</code>) in interval,</li>
<li><code>m2ll</code> - minus 2 times the log-likelihood for given rate, events and time on test (<code>2 *(rate*TTOT-events*log(rate))</code>).</li>
</ul>
<p>In test case 1 we can see that event rates are similar in the first 3 months for each treatment group and afterwards are substantially reduced in the experimental group. Within each treatment group, failure rates are reasonably constant after month 3. We show code for the first table printing, but suppress showing code for later analogous table generation statements.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Ex1Rate1 &lt;-<span class="st"> </span><span class="kw">with</span>(<span class="kw">subset</span>(Ex1delayedEffect,trt==<span class="dv">1</span>), <span class="kw">pwexpfit</span>(<span class="kw">Surv</span>(month,evntd))),
      <span class="dt">caption=</span><span class="st">&quot;Test case 1 piecewise exponential fit, experimental group&quot;</span>)</code></pre></div>
<table>
<caption>Test case 1 piecewise exponential fit, experimental group</caption>
<thead>
<tr class="header">
<th align="right">intervals</th>
<th align="right">TTOT</th>
<th align="right">events</th>
<th align="right">rate</th>
<th align="right">m2ll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">620.4375</td>
<td align="right">64</td>
<td align="right">0.1031530</td>
<td align="right">418.75734</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">415.8482</td>
<td align="right">36</td>
<td align="right">0.0865700</td>
<td align="right">248.16970</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">256.2053</td>
<td align="right">19</td>
<td align="right">0.0741593</td>
<td align="right">136.85853</td>
</tr>
<tr class="even">
<td align="right">Inf</td>
<td align="right">205.4186</td>
<td align="right">13</td>
<td align="right">0.0632854</td>
<td align="right">97.76261</td>
</tr>
</tbody>
</table>
<table>
<caption>Test case 1 piecewise exponential fit, control group</caption>
<thead>
<tr class="header">
<th align="right">intervals</th>
<th align="right">TTOT</th>
<th align="right">events</th>
<th align="right">rate</th>
<th align="right">m2ll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">316.74106</td>
<td align="right">33</td>
<td align="right">0.1041861</td>
<td align="right">215.26408</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">189.50899</td>
<td align="right">35</td>
<td align="right">0.1846878</td>
<td align="right">188.23619</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">90.64288</td>
<td align="right">11</td>
<td align="right">0.1213554</td>
<td align="right">68.39871</td>
</tr>
<tr class="even">
<td align="right">Inf</td>
<td align="right">48.69624</td>
<td align="right">7</td>
<td align="right">0.1437483</td>
<td align="right">41.15568</td>
</tr>
</tbody>
</table>
</div>
<div id="testing-for-treatment-effect" class="section level3">
<h3>Testing for treatment effect</h3>
<p>If we fit the same piecewise exponential model with no difference between treatment groups and sum <code>m2ll</code> for that model compared to <code>m2ll</code> for the combined fits by treatment group, we can perform a 4 df Chi-square test for treatment effect. We compare this p-value with a logrank and find they are nearly identical.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ex1RateAll &lt;-<span class="st">  </span><span class="kw">with</span>(Ex1delayedEffect, <span class="kw">pwexpfit</span>(<span class="kw">Surv</span>(month,evntd)))
<span class="kw">pchisq</span>(<span class="kw">sum</span>(Ex1RateAll$m2ll)-<span class="kw">sum</span>(Ex1Rate0$m2ll+Ex1Rate1$m2ll),<span class="dt">df=</span><span class="dv">4</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 0.006424744</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lr1 &lt;-<span class="st"> </span><span class="kw">with</span>(Ex1delayedEffect, <span class="kw">survdiff</span>(<span class="dt">formula =</span> <span class="kw">Surv</span>(month, evntd) ~<span class="st"> </span>trt))$chisq
<span class="kw">pchisq</span>(lr1,<span class="dt">df=</span><span class="dv">1</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## [1] 0.006718952</code></pre>
<p>For test case 2, we see a similar pattern below. However, the early event rate where event rates are similar has a higher rate and the drop in rates for the next 6 months is more substantial. An immediate question comes as to which of test cases 1 and 2 has a more impressive treatment effect; a question that will obviously depend on the metric used. The 4 degree of freedom likelihood ratio test p-value in this case is 0.00035 compared to 0.00672 for the logrank test; thus, in this case the non-proportional hazards has clearly left room for a more sensitive test than logrank. In this case, there may be a dropoff in the event rate in both treatment groups late in follow-up, but follow-up there is limited enough that this may be a questionable conclusion.</p>
<table>
<caption>Test case 2 piecewise exponential fit, experimental group</caption>
<thead>
<tr class="header">
<th align="right">intervals</th>
<th align="right">TTOT</th>
<th align="right">events</th>
<th align="right">rate</th>
<th align="right">m2ll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">308.8478</td>
<td align="right">62</td>
<td align="right">0.2007461</td>
<td align="right">323.10857</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">172.2464</td>
<td align="right">20</td>
<td align="right">0.1161127</td>
<td align="right">126.12775</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">114.8007</td>
<td align="right">12</td>
<td align="right">0.1045290</td>
<td align="right">78.19898</td>
</tr>
<tr class="even">
<td align="right">Inf</td>
<td align="right">244.2830</td>
<td align="right">11</td>
<td align="right">0.0450297</td>
<td align="right">90.20951</td>
</tr>
</tbody>
</table>
<table>
<caption>Test case 2 piecewise exponential fit, control group</caption>
<thead>
<tr class="header">
<th align="right">intervals</th>
<th align="right">TTOT</th>
<th align="right">events</th>
<th align="right">rate</th>
<th align="right">m2ll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">309.66667</td>
<td align="right">72</td>
<td align="right">0.2325081</td>
<td align="right">354.07157</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">122.12320</td>
<td align="right">33</td>
<td align="right">0.2702189</td>
<td align="right">152.36251</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">44.73551</td>
<td align="right">16</td>
<td align="right">0.3576577</td>
<td align="right">64.90173</td>
</tr>
<tr class="even">
<td align="right">Inf</td>
<td align="right">71.93500</td>
<td align="right">2</td>
<td align="right">0.0278029</td>
<td align="right">18.33046</td>
</tr>
</tbody>
</table>
</div>
<div id="estimating-the-hazard-ratio-over-time" class="section level3">
<h3>Estimating the hazard ratio over time</h3>
<p>We can look at the hazard ratio in each interval as follows using the information just created:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example 1 piecewise hazard ratios</span>
Ex1Rate1$rate /<span class="st"> </span>Ex1Rate0$rate</code></pre></div>
<pre><code>## [1] 0.9900847 0.4687372 0.6110917 0.4402517</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example 2 piecewise hazard ratios</span>
Ex2Rate1$rate /<span class="st"> </span>Ex2Rate0$rate</code></pre></div>
<pre><code>## [1] 0.8633942 0.4296988 0.2922599 1.6196071</code></pre>
</div>
<div id="model-simplification" class="section level3">
<h3>Model simplification</h3>
<p>Now we consider simplifying the piecewise exponential model for test case 1. We assume a common failure rate for the first 3 months across treatment groups and a single rate thereafter. The code has some level of detail as subsetting and recombining is involved; however, no new concepts are introduced, so we do not show the code.</p>
<table>
<caption>2-piece exponential fit with HR=1 for first 3 months, test case 1.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">TTOT</th>
<th align="right">events</th>
<th align="right">rate</th>
<th align="right">m2ll</th>
<th align="left">Treatment</th>
<th align="left">Period</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="right">937.1785</td>
<td align="right">97</td>
<td align="right">0.1035022</td>
<td align="right">634.0236</td>
<td align="left">Combined</td>
<td align="left">&lt; 3 months</td>
</tr>
<tr class="even">
<td>2</td>
<td align="right">328.8481</td>
<td align="right">53</td>
<td align="right">0.1611686</td>
<td align="right">299.4822</td>
<td align="left">Control</td>
<td align="left">&gt; month 3</td>
</tr>
<tr class="odd">
<td>21</td>
<td align="right">877.4721</td>
<td align="right">68</td>
<td align="right">0.0774953</td>
<td align="right">483.8251</td>
<td align="left">Experimental</td>
<td align="left">&gt; month 3</td>
</tr>
</tbody>
</table>
<p>The hazard ratio after the first 3 months is 0.48. The 5 df Chi-square test for improvement of the full model over this 3 parameter model is (<span class="math inline">\(-2\times \hbox{log-likelihood}=\)</span> 1414.6) vs. the full model fit above with piecewise exponential in each treatment group (<span class="math inline">\(-2 \times \hbox{log-likelihood}=\)</span> 1417.33) is 2.73 (<span class="math inline">\(p=\)</span> 0.742). This suggests the simplified model with a common exponential failure rate for the first 3 months followed by an exponential failure rate in each arm with a hazard ratio of 0.48 fits case study 1 reasonably well.</p>
</div>
<div id="overlay-of-kaplan-meier-and-simplified-exponential-model-curves" class="section level3">
<h3>Overlay of Kaplan-Meier and Simplified Exponential Model curves</h3>
<p>Now we overlay the Kaplan-Meier curve from test case 1 with the simplified piecewise exponential fit.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="possible-models-for-design-and-simulations-based-on-examples" class="section level3">
<h3>Possible models for design and simulations based on examples</h3>
<p>For test case 1, a reasonable approximation would be a common exponential failure rate of 0.10 per month for the first 3 months followed by an exponential failure rate of 0.16 per month in the control group and 0.08 in the experimental group yielding a hazard ratio of 0.5 after month 3.</p>
</div>
</div>
<div id="cure-with-proportional-hazards-case-3" class="section level2">
<h2>Cure with proportional hazards: case 3</h2>
</div>
<div id="belly-shaped-case-4" class="section level2">
<h2>Belly shaped: case 4</h2>
</div>
<div id="widening-case-5" class="section level2">
<h2>Widening: case 5</h2>
</div>
<div id="crossing-case-6" class="section level2">
<h2>Crossing: case 6</h2>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
